version: "3"

# Taskfile for WhatsApp API Project
# Install Task: https://taskfile.dev/installation/
# Usage: task [command]

vars:
  SERVER_DIR: apps/server
  WEB_DIR: apps/web
  SERVER_PORT: 8080
  WEB_PORT: 3001

tasks:
  # ============================================================================
  # Development Tasks
  # ============================================================================

  dev:
    desc: "Start both backend and frontend in development mode"
    deps:
      - dev:backend
      - dev:frontend

  dev:backend:
    desc: "Start Go backend server in development mode"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "üöÄ Starting backend server on port {{.SERVER_PORT}}..."
      - go run cmd/whatsapp/main.go
    silent: false

  dev:frontend:
    desc: "Start React frontend dev server"
    dir: "{{.WEB_DIR}}"
    cmds:
      - echo "üöÄ Starting frontend dev server on port {{.WEB_PORT}}..."
      - npm run dev
    silent: false

  # ============================================================================
  # Build Tasks
  # ============================================================================

  build:
    desc: "Build both backend and frontend for production"
    cmds:
      - task: build:backend
      - task: build:frontend

  build:backend:
    desc: "Build Go backend binary"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "üî® Building backend..."
      - go build -o ../../bin/whatsapp-server cmd/whatsapp/main.go
      - echo "‚úÖ Backend built successfully bin/whatsapp-server"

  build:frontend:
    desc: "Build React frontend for production"
    dir: "{{.WEB_DIR}}"
    cmds:
      - echo "üî® Building frontend..."
      - npm run build
      - echo "‚úÖ Frontend built successfully in apps/web/dist"

  # ============================================================================
  # Install Dependencies
  # ============================================================================

  install:
    desc: "Install all dependencies (backend and frontend)"
    cmds:
      - task: install:backend
      - task: install:frontend

  install:backend:
    desc: "Install Go dependencies"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "üì¶ Installing Go dependencies..."
      - go mod download
      - go mod tidy
      - echo "‚úÖ Go dependencies installed"

  install:frontend:
    desc: "Install npm dependencies"
    dir: "{{.WEB_DIR}}"
    cmds:
      - echo "üì¶ Installing npm dependencies..."
      - npm install
      - echo "‚úÖ npm dependencies installed"

  # ============================================================================
  # Testing Tasks
  # ============================================================================

  test:
    desc: "Run all tests (backend and frontend)"
    cmds:
      - task: test:backend
      - task: test:frontend

  test:backend:
    desc: "Run Go tests"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "üß™ Running backend tests..."
      - go test ./... -v

  test:backend:coverage:
    desc: "Run Go tests with coverage"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "üß™ Running backend tests with coverage..."
      - go test ./... -coverprofile=coverage.out
      - go tool cover -html=coverage.out -o coverage.html
      - echo "‚úÖ Coverage report generated in apps/server/coverage.html"

  test:frontend:
    desc: "Run frontend tests"
    dir: "{{.WEB_DIR}}"
    cmds:
      - echo "üß™ Running frontend tests..."
      - npm run test

  # ============================================================================
  # Linting & Formatting
  # ============================================================================

  lint:
    desc: "Lint all code (backend and frontend)"
    cmds:
      - task: lint:backend
      - task: lint:frontend

  lint:backend:
    desc: "Lint Go code"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "üîç Linting backend code..."
      - go vet ./...
      - go fmt ./...
      - echo "‚úÖ Backend linting complete"

  lint:frontend:
    desc: "Lint frontend code"
    dir: "{{.WEB_DIR}}"
    cmds:
      - echo "üîç Linting frontend code..."
      - npm run lint
      - echo "‚úÖ Frontend linting complete"

  # ============================================================================
  # Database Tasks
  # ============================================================================

  db:migrate:
    desc: "Run database migrations"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "üóÑÔ∏è  Running database migrations..."
      - go run cmd/whatsapp/main.go migrate
      - echo "‚úÖ Migrations complete"

  db:reset:
    desc: "Reset database (WARNING: Deletes all data)"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "‚ö†Ô∏è  WARNING - This will delete all data"
      - cmd: |
          read -p "Are you sure? (yes/no): " confirm
          if [ "$confirm" = "yes" ]; then
            rm -f /data/whatsmeow.db
            echo "‚úÖ Database reset complete"
          else
            echo "‚ùå Database reset cancelled"
          fi
    platforms: [linux, darwin]

  db:reset:windows:
    desc: "Reset database on Windows (WARNING: Deletes all data)"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "‚ö†Ô∏è  WARNING - This will delete all data"
      - cmd: |
          $confirm = Read-Host "Are you sure? (yes/no)"
          if ($confirm -eq "yes") {
            Remove-Item -Path "/data/whatsmeow.db" -Force -ErrorAction SilentlyContinue
            Write-Host "‚úÖ Database reset complete"
          } else {
            Write-Host "‚ùå Database reset cancelled"
          }
    platforms: [windows]

  # ============================================================================
  # Cleanup Tasks
  # ============================================================================

  clean:
    desc: "Clean all build artifacts and dependencies"
    cmds:
      - task: clean:backend
      - task: clean:frontend

  clean:backend:
    desc: "Clean Go build artifacts"
    dir: "{{.SERVER_DIR}}"
    cmds:
      - echo "üßπ Cleaning backend artifacts..."
      - go clean
      - rm -rf bin/
      - echo "‚úÖ Backend cleaned"

  clean:frontend:
    desc: "Clean frontend build artifacts"
    dir: "{{.WEB_DIR}}"
    cmds:
      - echo "üßπ Cleaning frontend artifacts..."
      - rm -rf dist/
      - rm -rf node_modules/
      - echo "‚úÖ Frontend cleaned"

  # ============================================================================
  # Docker Tasks
  # ============================================================================

  docker:up:
    desc: "Start Docker containers (builds images first)"
    cmds:
      - echo "üê≥ Starting Docker containers..."
      - docker compose build
      - docker compose up -d
      - echo "‚úÖ Docker containers started"
      - echo "üìä Container status:"
      - docker compose ps

  docker:start:
    desc: "Start existing Docker containers (no build)"
    cmds:
      - echo "üê≥ Starting Docker containers..."
      - docker compose up -d
      - echo "‚úÖ Docker containers started"
      - docker compose ps

  docker:down:
    desc: "Stop Docker containers"
    cmds:
      - echo "üê≥ Stopping Docker containers..."
      - docker compose down
      - echo "‚úÖ Docker containers stopped"

  docker:restart:
    desc: "Restart Docker containers"
    cmds:
      - echo "üîÑ Restarting Docker containers..."
      - docker compose restart
      - echo "‚úÖ Docker containers restarted"

  docker:logs:
    desc: "View Docker container logs (all services)"
    cmds:
      - docker compose logs -f

  docker:logs:backend:
    desc: "View WhatsApp service logs only"
    cmds:
      - docker compose logs -f whatsapp-service

  docker:logs:postgres:
    desc: "View PostgreSQL logs only"
    cmds:
      - docker compose logs -f postgres

  docker:build:
    desc: "Build Docker images"
    cmds:
      - echo "üê≥ Building Docker images..."
      - docker compose build --no-cache
      - echo "‚úÖ Docker images built"

  docker:build:backend:
    desc: "Build only WhatsApp service Docker image"
    cmds:
      - echo "üê≥ Building WhatsApp service image..."
      - docker compose build app
      - echo "‚úÖ WhatsApp service image built"

  docker:rebuild:
    desc: "Rebuild and restart Docker containers"
    cmds:
      - task: docker:down
      - task: docker:build
      - task: docker:up

  docker:ps:
    desc: "Show running Docker containers"
    cmds:
      - docker compose ps

  docker:stats:
    desc: "Show Docker container resource usage"
    cmds:
      - docker stats --no-stream

  docker:exec:backend:
    desc: "Execute shell in WhatsApp service container"
    cmds:
      - docker compose exec whatsapp-service sh

  docker:exec:postgres:
    desc: "Execute psql in PostgreSQL container"
    cmds:
      - docker compose exec postgres psql -U whatspire -d whatspire_test

  docker:clean:
    desc: "Clean up Docker resources (containers, images, volumes)"
    cmds:
      - echo "üßπ Cleaning Docker resources..."
      - docker compose down -v
      - docker system prune -f
      - echo "‚úÖ Docker cleanup complete"

  docker:clean:all:
    desc: "Deep clean all Docker resources (WARNING: removes all unused Docker data)"
    cmds:
      - echo "‚ö†Ô∏è  WARNING - This will remove all unused Docker containers, images, and volumes"
      - cmd: |
          {{if eq OS "windows"}}
          $confirm = Read-Host "Are you sure? (yes/no)"
          if ($confirm -eq "yes") {
            docker compose down -v
            docker system prune -a -f --volumes
            Write-Host "‚úÖ Deep Docker cleanup complete"
          } else {
            Write-Host "‚ùå Cleanup cancelled"
          }
          {{else}}
          read -p "Are you sure? (yes/no): " confirm
          if [ "$confirm" = "yes" ]; then
            docker compose down -v
            docker system prune -a -f --volumes
            echo "‚úÖ Deep Docker cleanup complete"
          else
            echo "‚ùå Cleanup cancelled"
          fi
          {{end}}

  docker:health:
    desc: "Check health status of Docker containers"
    cmds:
      - echo "üè• Checking container health..."
      - docker compose ps
      - echo ""
      - echo "WhatsApp Service Health:"
      - docker inspect --format='{{`{{.State.Health.Status}}`}}' whatspire-whatsapp-service || echo "No health check configured"
      - echo ""
      - echo "PostgreSQL Health:"
      - docker inspect --format='{{`{{.State.Health.Status}}`}}' whatspire-postgres || echo "No health check configured"

  docker:backup:
    desc: "Backup Docker volumes and data"
    cmds:
      - echo "üíæ Creating backup..."
      - mkdir -p backups
      - |
        {{if eq OS "windows"}}
        $timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
        Compress-Archive -Path apps/server/data -DestinationPath "backups/whatsapp-backup-$timestamp.zip"
        Write-Host "‚úÖ Backup created: backups/whatsapp-backup-$timestamp.zip"
        {{else}}
        timestamp=$(date +%Y%m%d_%H%M%S)
        tar -czf backups/whatsapp-backup-$timestamp.tar.gz apps/server/data
        echo "‚úÖ Backup created: backups/whatsapp-backup-$timestamp.tar.gz"
        {{end}}

  # ============================================================================
  # Production Tasks
  # ============================================================================

  prod:deploy:
    desc: "Deploy to production (build and start all services)"
    cmds:
      - echo "üöÄ Deploying to production..."
      - task: prod:check-env
      - echo "Building images..."
      - docker-compose -f docker-compose.production.yml --env-file .env.production build
      - echo "Starting services..."
      - docker-compose -f docker-compose.production.yml --env-file .env.production up -d
      - echo "‚úÖ Production deployment complete!"
      - task: prod:status

  prod:up:
    desc: "Start production Docker containers"
    cmds:
      - echo "üê≥ Starting production containers..."
      - docker-compose -f docker-compose.production.yml --env-file .env.production up -d
      - echo "‚úÖ Production containers started"
      - docker-compose -f docker-compose.production.yml ps

  prod:down:
    desc: "Stop production Docker containers"
    cmds:
      - echo "üê≥ Stopping production containers..."
      - docker-compose -f docker-compose.production.yml down
      - echo "‚úÖ Production containers stopped"

  prod:restart:
    desc: "Restart production Docker containers"
    cmds:
      - echo "üîÑ Restarting production containers..."
      - docker-compose -f docker-compose.production.yml restart
      - echo "‚úÖ Production containers restarted"

  prod:build:
    desc: "Build production Docker images"
    cmds:
      - echo "üî® Building production images..."
      - docker-compose -f docker-compose.production.yml build --no-cache
      - echo "‚úÖ Production images built"

  prod:rebuild:
    desc: "Rebuild and restart production containers"
    cmds:
      - echo "üîÑ Rebuilding production deployment..."
      - task: prod:down
      - task: prod:build
      - task: prod:up
      - echo "‚úÖ Production rebuild complete"

  prod:logs:
    desc: "View production logs (all services)"
    cmds:
      - docker-compose -f docker-compose.production.yml logs -f

  prod:logs:backend:
    desc: "View production WhatsApp service logs"
    cmds:
      - docker-compose -f docker-compose.production.yml logs -f whatsapp-service

  prod:logs:postgres:
    desc: "View production PostgreSQL logs"
    cmds:
      - docker-compose -f docker-compose.production.yml logs -f postgres

  prod:status:
    desc: "Check production services status"
    cmds:
      - echo "üìä Production Services Status"
      - echo "=============================="
      - docker-compose -f docker-compose.production.yml ps
      - echo ""
      - echo "Health Checks:"
      - |
        {{if eq OS "windows"}}
        docker inspect --format="{{`{{.State.Health.Status}}`}}" whatspire-whatsapp-prod 2>$null
        if ($LASTEXITCODE -ne 0) { Write-Host "WhatsApp Service: Not running" }
        docker inspect --format="{{`{{.State.Health.Status}}`}}" whatspire-postgres-prod 2>$null
        if ($LASTEXITCODE -ne 0) { Write-Host "PostgreSQL: Not running" }
        {{else}}
        docker inspect --format='{{`{{.State.Health.Status}}`}}' whatspire-whatsapp-prod 2>/dev/null || echo "WhatsApp Service: Not running"
        docker inspect --format='{{`{{.State.Health.Status}}`}}' whatspire-postgres-prod 2>/dev/null || echo "PostgreSQL: Not running"
        {{end}}

  prod:health:
    desc: "Check production services health"
    cmds:
      - echo "üè• Checking production health..."
      - echo ""
      - echo "Container Health Status:"
      - docker-compose -f docker-compose.production.yml ps
      - echo ""
      - echo "Application Health Endpoint:"
      - curl -f http://localhost:8080/health || echo "‚ùå Health check failed"
      - echo ""
      - echo "Database Connection:"
      - docker exec whatspire-postgres-prod pg_isready -U whatspire || echo "‚ùå Database not ready"

  prod:stats:
    desc: "Show production resource usage"
    cmds:
      - echo "üìä Production Resource Usage"
      - docker stats --no-stream whatspire-whatsapp-prod whatspire-postgres-prod

  prod:exec:backend:
    desc: "Execute shell in production WhatsApp service"
    cmds:
      - docker-compose -f docker-compose.production.yml exec whatsapp-service sh

  prod:exec:postgres:
    desc: "Execute psql in production PostgreSQL"
    cmds:
      - docker-compose -f docker-compose.production.yml exec postgres psql -U whatspire -d whatspire_prod

  prod:backup:
    desc: "Backup production data and database"
    cmds:
      - echo "üíæ Creating production backup..."
      - mkdir -p backups/production
      - |
        {{if eq OS "windows"}}
        $timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
        Write-Host "Backing up PostgreSQL database..."
        docker exec whatspire-postgres-prod pg_dump -U whatspire whatspire_prod | Out-File -Encoding UTF8 "backups/production/postgres_$timestamp.sql"
        Write-Host "Backing up WhatsApp data..."
        Compress-Archive -Path apps/server/data -DestinationPath "backups/production/whatsapp_$timestamp.zip" -Force
        Write-Host "Backing up configuration..."
        Copy-Item apps/server/config.yaml "backups/production/config_$timestamp.yaml"
        Copy-Item .env.production "backups/production/env_$timestamp.txt"
        Write-Host "‚úÖ Production backup created: backups/production/*_$timestamp.*"
        {{else}}
        timestamp=$(date +%Y%m%d_%H%M%S)
        echo "Backing up PostgreSQL database..."
        docker exec whatspire-postgres-prod pg_dump -U whatspire whatspire_prod | gzip > backups/production/postgres_$timestamp.sql.gz
        echo "Backing up WhatsApp data..."
        tar -czf backups/production/whatsapp_$timestamp.tar.gz apps/server/data
        echo "Backing up configuration..."
        cp apps/server/config.yaml backups/production/config_$timestamp.yaml
        cp .env.production backups/production/env_$timestamp.txt
        echo "‚úÖ Production backup created: backups/production/*_$timestamp.*"
        {{end}}

  prod:restore:
    desc: "Restore production from backup (requires BACKUP_DATE variable)"
    cmds:
      - echo "‚ö†Ô∏è  WARNING - This will restore production data from backup"
      - |
        {{if eq OS "windows"}}
        if (-not $env:BACKUP_DATE) {
          Write-Host "‚ùå Error: BACKUP_DATE environment variable required"
          Write-Host "Usage: $env:BACKUP_DATE='20240207_120000'; task prod:restore"
          exit 1
        }
        $confirm = Read-Host "Restore from backup $env:BACKUP_DATE? (yes/no)"
        if ($confirm -eq "yes") {
          Write-Host "Stopping services..."
          docker-compose -f docker-compose.production.yml down
          Write-Host "Restoring database..."
          Get-Content "backups/production/postgres_$env:BACKUP_DATE.sql" | docker exec -i whatspire-postgres-prod psql -U whatspire whatspire_prod
          Write-Host "Restoring WhatsApp data..."
          Expand-Archive -Path "backups/production/whatsapp_$env:BACKUP_DATE.zip" -DestinationPath . -Force
          Write-Host "Starting services..."
          docker-compose -f docker-compose.production.yml up -d
          Write-Host "‚úÖ Production restore complete"
        } else {
          Write-Host "‚ùå Restore cancelled"
        }
        {{else}}
        if [ -z "$BACKUP_DATE" ]; then
          echo "‚ùå Error: BACKUP_DATE environment variable required"
          echo "Usage: BACKUP_DATE=20240207_120000 task prod:restore"
          exit 1
        fi
        read -p "Restore from backup $BACKUP_DATE? (yes/no): " confirm
        if [ "$confirm" = "yes" ]; then
          echo "Stopping services..."
          docker-compose -f docker-compose.production.yml down
          echo "Restoring database..."
          gunzip < backups/production/postgres_$BACKUP_DATE.sql.gz | docker exec -i whatspire-postgres-prod psql -U whatspire whatspire_prod
          echo "Restoring WhatsApp data..."
          tar -xzf backups/production/whatsapp_$BACKUP_DATE.tar.gz
          echo "Starting services..."
          docker-compose -f docker-compose.production.yml up -d
          echo "‚úÖ Production restore complete"
        else
          echo "‚ùå Restore cancelled"
        fi
        {{end}}

  prod:update:
    desc: "Update production deployment (pull, rebuild, restart)"
    cmds:
      - echo "üîÑ Updating production deployment..."
      - echo "Pulling latest code..."
      - git pull
      - echo "Creating backup before update..."
      - task: prod:backup
      - echo "Rebuilding images..."
      - task: prod:build
      - echo "Restarting services..."
      - task: prod:restart
      - echo "‚úÖ Production update complete"
      - task: prod:status

  prod:clean:
    desc: "Clean production Docker resources"
    cmds:
      - echo "üßπ Cleaning production resources..."
      - docker-compose -f docker-compose.production.yml down -v
      - docker system prune -f
      - echo "‚úÖ Production cleanup complete"

  prod:check-env:
    desc: "Check if production environment is configured"
    cmds:
      - |
        {{if eq OS "windows"}}
        if (-not (Test-Path .env.production)) {
          Write-Host "‚ùå Error: .env.production file not found"
          Write-Host "Please create it from .env.production.example"
          exit 1
        }
        Write-Host "‚úÖ Production environment configured"
        {{else}}
        if [ ! -f .env.production ]; then
          echo "‚ùå Error: .env.production file not found"
          echo "Please create it from .env.production.example"
          exit 1
        fi
        echo "‚úÖ Production environment configured"
        {{end}}

  prod:setup:
    desc: "Initial production setup (create env file and directories)"
    cmds:
      - echo "üîß Setting up production environment..."
      - |
        {{if eq OS "windows"}}
        if (-not (Test-Path .env.production)) {
          Copy-Item .env.production.example .env.production
          Write-Host "‚úÖ Created .env.production - Please edit with your settings"
        } else {
          Write-Host "‚ö†Ô∏è  .env.production already exists"
        }
        New-Item -ItemType Directory -Force -Path data/postgres, data/whatsapp, backups/production | Out-Null
        Write-Host "‚úÖ Created data directories"
        Write-Host ""
        Write-Host "Next steps:"
        Write-Host "1. Edit .env.production with your settings"
        Write-Host "2. Edit apps/server/config.yaml with production config"
        Write-Host "3. Run: task prod:deploy"
        {{else}}
        if [ ! -f .env.production ]; then
          cp .env.production.example .env.production
          echo "‚úÖ Created .env.production - Please edit with your settings"
        else
          echo "‚ö†Ô∏è  .env.production already exists"
        fi
        mkdir -p data/postgres data/whatsapp backups/production
        echo "‚úÖ Created data directories"
        echo ""
        echo "Next steps:"
        echo "1. Edit .env.production with your settings"
        echo "2. Edit apps/server/config.yaml with production config"
        echo "3. Run: task prod:deploy"
        {{end}}

  prod:db:migrate:
    desc: "Run database migrations in production"
    cmds:
      - echo "üóÑÔ∏è  Running production database migrations..."
      - docker-compose -f docker-compose.production.yml exec whatsapp-service /app/whatsapp-service migrate
      - echo "‚úÖ Migrations complete"

  prod:db:backup:
    desc: "Backup production database only"
    cmds:
      - echo "üíæ Backing up production database..."
      - mkdir -p backups/production
      - |
        {{if eq OS "windows"}}
        $timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
        docker exec whatspire-postgres-prod pg_dump -U whatspire whatspire_prod | Out-File -Encoding UTF8 "backups/production/postgres_$timestamp.sql"
        Write-Host "‚úÖ Database backup created: backups/production/postgres_$timestamp.sql"
        {{else}}
        timestamp=$(date +%Y%m%d_%H%M%S)
        docker exec whatspire-postgres-prod pg_dump -U whatspire whatspire_prod | gzip > backups/production/postgres_$timestamp.sql.gz
        echo "‚úÖ Database backup created: backups/production/postgres_$timestamp.sql.gz"
        {{end}}

  prod:db:vacuum:
    desc: "Vacuum and analyze production database"
    cmds:
      - echo "üóÑÔ∏è  Running database maintenance..."
      - docker exec whatspire-postgres-prod psql -U whatspire -d whatspire_prod -c "VACUUM ANALYZE;"
      - echo "‚úÖ Database maintenance complete"

  prod:logs:tail:
    desc: "Tail production logs (last 100 lines)"
    cmds:
      - docker-compose -f docker-compose.production.yml logs --tail=100

  prod:monitor:
    desc: "Monitor production services in real-time"
    cmds:
      - echo "üìä Monitoring production services (Ctrl+C to exit)..."
      - docker stats whatspire-whatsapp-prod whatspire-postgres-prod

  # ============================================================================
  # Utility Tasks
  # ============================================================================

  setup:
    desc: "Initial project setup (install dependencies and build)"
    cmds:
      - echo "üîß Setting up project..."
      - task: install
      - task: build
      - echo "‚úÖ Project setup complete!"

  check:
    desc: "Run all checks (lint, test, build)"
    cmds:
      - echo "üîç Running all checks..."
      - task: lint
      - task: test
      - task: build
      - echo "‚úÖ All checks passed!"

  status:
    desc: "Check status of running services"
    cmds:
      - echo "üìä Checking service status..."
      - cmd: |
          echo "Backend (port {{.SERVER_PORT}})"
          curl -s http://localhost:{{.SERVER_PORT}}/health || echo "  ‚ùå Not running"
          echo ""
          echo "Frontend (port {{.WEB_PORT}})"
          curl -s http://localhost:{{.WEB_PORT}} > /dev/null && echo "  ‚úÖ Running" || echo "  ‚ùå Not running"

  logs:
    desc: "View application logs"
    cmds:
      - echo "üìã Viewing logs..."
      - tail -f apps/server/logs/*.log

  # ============================================================================
  # Help
  # ============================================================================

  default:
    desc: "Show available tasks"
    cmds:
      - task --list

  help:
    desc: "Show detailed help information"
    cmds:
      - echo "üìö WhatsApp API Taskfile Help"
      - echo ""
      - echo "üöÄ Development Commands"
      - echo "  task dev              - Start both backend and frontend in dev mode"
      - echo "  task dev:backend      - Start only backend server"
      - echo "  task dev:frontend     - Start only frontend server"
      - echo ""
      - echo "üî® Build Commands"
      - echo "  task build            - Build both backend and frontend"
      - echo "  task build:backend    - Build only backend"
      - echo "  task build:frontend   - Build only frontend"
      - echo ""
      - echo "üß™ Testing Commands"
      - echo "  task test             - Run all tests"
      - echo "  task test:backend     - Run backend tests"
      - echo "  task test:backend:coverage - Run backend tests with coverage"
      - echo "  task test:frontend    - Run frontend tests"
      - echo ""
      - echo "üîç Linting Commands"
      - echo "  task lint             - Lint all code"
      - echo "  task lint:backend     - Lint backend code"
      - echo "  task lint:frontend    - Lint frontend code"
      - echo ""
      - echo "üê≥ Docker Commands (Development)"
      - echo "  task docker:up        - Start Docker containers"
      - echo "  task docker:down      - Stop Docker containers"
      - echo "  task docker:restart   - Restart Docker containers"
      - echo "  task docker:build     - Build Docker images"
      - echo "  task docker:build:backend - Build only backend image"
      - echo "  task docker:rebuild   - Rebuild and restart containers"
      - echo "  task docker:logs      - View all container logs"
      - echo "  task docker:logs:backend - View backend logs only"
      - echo "  task docker:logs:postgres - View PostgreSQL logs only"
      - echo "  task docker:ps        - Show running containers"
      - echo "  task docker:stats     - Show container resource usage"
      - echo "  task docker:health    - Check container health status"
      - echo "  task docker:exec:backend - Shell into backend container"
      - echo "  task docker:exec:postgres - psql into PostgreSQL"
      - echo "  task docker:backup    - Backup Docker volumes"
      - echo "  task docker:clean     - Clean Docker resources"
      - echo "  task docker:clean:all - Deep clean all Docker data"
      - echo ""
      - echo "üöÄ Production Commands"
      - echo "  task prod:setup       - Initial production setup"
      - echo "  task prod:deploy      - Deploy to production"
      - echo "  task prod:up          - Start production containers"
      - echo "  task prod:down        - Stop production containers"
      - echo "  task prod:restart     - Restart production containers"
      - echo "  task prod:build       - Build production images"
      - echo "  task prod:rebuild     - Rebuild production deployment"
      - echo "  task prod:update      - Update production (pull, rebuild, restart)"
      - echo "  task prod:status      - Check production status"
      - echo "  task prod:health      - Check production health"
      - echo "  task prod:stats       - Show production resource usage"
      - echo "  task prod:monitor     - Monitor production in real-time"
      - echo "  task prod:logs        - View production logs"
      - echo "  task prod:logs:backend - View production backend logs"
      - echo "  task prod:logs:postgres - View production database logs"
      - echo "  task prod:logs:tail   - Tail last 100 lines of logs"
      - echo "  task prod:backup      - Backup production data and database"
      - echo "  task prod:restore     - Restore from backup (set BACKUP_DATE)"
      - echo "  task prod:db:backup   - Backup database only"
      - echo "  task prod:db:migrate  - Run database migrations"
      - echo "  task prod:db:vacuum   - Vacuum and analyze database"
      - echo "  task prod:exec:backend - Shell into production backend"
      - echo "  task prod:exec:postgres - psql into production database"
      - echo "  task prod:clean       - Clean production resources"
      - echo ""
      - echo "üóÑÔ∏è  Database Commands"
      - echo "  task db:migrate       - Run database migrations"
      - echo "  task db:reset         - Reset database (deletes all data)"
      - echo ""
      - echo "üßπ Cleanup Commands"
      - echo "  task clean            - Clean all build artifacts"
      - echo "  task clean:backend    - Clean backend artifacts"
      - echo "  task clean:frontend   - Clean frontend artifacts"
      - echo ""
      - echo "üîß Utility Commands"
      - echo "  task setup            - Initial project setup"
      - echo "  task check            - Run all checks (lint, test, build)"
      - echo "  task status           - Check service status"
      - echo ""
      - 'echo "For full list of tasks, run: task --list"'
